<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard B√°o C√°o Nh√¢n S·ª±</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            color: #1f2937;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 0;
            box-shadow: none;
            text-align: left;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        header img {
            height: 60px;
            width: auto;
        }

        header h1 {
            font-size: 32px;
            font-weight: 700;
            margin: 0;
        }

        header p {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Main layout: sidebar + content */
        .main-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Navigation */
        .nav-container {
            background: #1a2744;
            border-right: 1px solid #e5e7eb;
            width: 200px;
            display: flex;
            flex-direction: column;
            gap: 0;
            padding: 0;
            overflow-y: auto;
            flex-shrink: 0;
            color: white;
            position: relative;
        }

        .nav-footer {
            margin-top: auto;
            padding: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 10px;
            color: #9ca3af;
            text-align: center;
            flex-shrink: 0;
        }

        .nav-item {
            padding: 10px 16px;
            font-size: 14px;
            font-weight: 600;
            color: #cbd5e1;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            display: block;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #e0f2fe;
        }

        .nav-item.active {
            color: white;
            border-left-color: #0ea5e9;
        }
        
        .nav-item.active:not([style*="linear-gradient"]) {
            background: #2563eb;
        }
        
        .nav-footer .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        }

        .nav-btn {
            width: 100%;
            padding: 12px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #dbeafe;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            text-align: left;
            white-space: nowrap;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .nav-btn.active {
            background: #2563eb;
            color: white;
            border-left-color: #0ea5e9;
        }

        /* Content wrapper */
        .content-wrapper {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .content-inner {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* Footer */
        footer {
            padding: 20px 30px;
            border-top: 1px solid #e5e7eb;
            background: white;
            text-align: right;
            font-size: 12px;
            color: #9ca3af;
            flex-shrink: 0;
            display: none;
        }

        /* Pages */
        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #2563eb;
        }

        .stat-card.green { border-left-color: #10b981; }
        .stat-card.yellow { border-left-color: #f59e0b; }
        .stat-card.red { border-left-color: #ef4444; }

        .nav-section-title {
            padding: 10px 12px 8px;
            font-size: 16px;
            font-weight: 700;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .nav-section-title img {
            height: 45px;
            width: auto;
            margin: 0;
        }

        .stat-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 2px;
        }

        .stat-change {
            font-size: 12px;
            color: #6b7280;
        }

        .stat-change.up { color: #10b981; }
        .stat-change.down { color: #ef4444; }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .chart-wrapper {
            height: 280px;
        }

        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        table tbody tr:hover {
            background: #f9fafb;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success { background: #d1fae5; color: #065f46; }
        .badge-warning { background: #fef3c7; color: #92400e; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-info { background: #dbeafe; color: #0c2d6b; }

        /* Filters */
        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
            color: #4b5563;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* Two Column Layout */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 20px;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb 0%, #0ea5e9 100%);
            transition: width 0.3s ease;
        }

        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .two-column {
                grid-template-columns: 1fr;
            }

            .nav-container {
                width: 180px;
            }

            header h1 {
                font-size: 28px;
            }

            .content-wrapper {
                padding: 20px;
            }

            .nav-footer {
                font-size: 10px;
                padding: 12px;
            }
        }

        @media (max-width: 768px) {
            .main-wrapper {
                flex-direction: column;
            }

            .nav-container {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
                flex-direction: row;
                padding: 0;
                overflow-y: unset;
                overflow-x: auto;
            }

            .nav-section-title {
                display: none;
            }

            .nav-group-title {
                border-left: none;
                border-bottom: 3px solid transparent;
                flex: 1;
                min-width: 120px;
                padding: 12px 15px;
            }

            .nav-group-title.active {
                border-left: none;
                border-bottom-color: #2563eb;
                background: #2563eb;
            }

            .nav-submenu {
                display: none;
            }

            .nav-item {
                display: none;
            }

            .content-wrapper {
                padding: 15px;
            }

            .page-title {
                font-size: 22px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }

            .chart-container {
                min-height: 280px;
            }

            header h1 {
                font-size: 24px;
            }

            footer {
                padding: 15px 20px;
                font-size: 11px;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 900px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-header h2 {
            margin: 0;
            color: #1f2937;
            font-size: 24px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #6b7280;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: #1f2937;
        }

        .help-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            margin-top: 10px;
            font-weight: 600;
            width: 100%;
        }

        .help-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.6);
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- Main wrapper: nav + content -->
        <div class="main-wrapper">
            <!-- Navigation -->
            <div class="nav-container">
                <div class="nav-section-title">
                    <img src="assets/t·∫£i xu·ªëng.png" alt="TPP Logo">
                    B√°o C√°o Nh√¢n S·ª±
                </div>
                
                <button class="nav-item active" data-page="page1" onclick="showPage('page1')">üìà T·ªïng Quan</button>
                <button class="nav-item" data-page="page2" onclick="showPage('page2')">üë• Nh√¢n S·ª±</button>
                <button class="nav-item" data-page="page3" onclick="showPage('page3')">üí∞ L∆∞∆°ng</button>
                <button class="nav-item" data-page="page4" onclick="showPage('page4')">‚úÖ C√¥ng Vi·ªác</button>

                <div class="nav-footer">
                    <span id="lastUpdate">C·∫≠p nh·∫≠t:<br>4/1/2026</span>
                    <button class="help-btn" onclick="openHelpModal()">‚ùì H∆∞·ªõng D·∫´n</button>
                </div>
            </div>

            <!-- Content wrapper -->
            <div class="content-wrapper">
                <div class="content-inner">
                    <!-- PAGE 1: T·ªîNG QUAN -->
                    <div id="page1" class="page active">
                <h2 class="page-title">üìà T·ªïng Quan Nh√¢n S·ª±</h2>

            <!-- ALL STAT CARDS - 2 GROUPS IN 1 ROW -->
            <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 15px; margin-bottom: 20px;">
                <!-- GROUP 1: NH√ÇN S·ª∞ & L∆Ø∆†NG -->
                <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); padding: 15px; border-radius: 12px; border: 1px solid #bfdbfe;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 8px; color: #2563eb;">üë• Nh√¢n S·ª± & L∆∞∆°ng</h3>
                    <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <div class="stat-card" style="padding: 12px; margin: 0;">
                            <div class="stat-label">T·ªïng Nh√¢n S·ª±</div>
                            <div class="stat-value">245</div>
                            <div class="stat-change up">‚Üë +5</div>
                        </div>
                        <div class="stat-card red" style="padding: 12px; margin: 0;">
                            <div class="stat-label">S·ªë L∆∞·ª£ng Tuy·ªÉn D·ª•ng</div>
                            <div class="stat-value">8</div>
                            <div class="stat-change">8 v·ªã tr√≠</div>
                        </div>
                        <div class="stat-card" style="padding: 12px; margin: 0;">
                            <div class="stat-label">T·ªïng Qu·ªπ L∆∞∆°ng</div>
                            <div class="stat-value">1.2B</div>
                            <div class="stat-change up">‚Üë +3.5%</div>
                        </div>
                    </div>
                </div>

                <!-- GROUP 2: C√îNG VI·ªÜC -->
                <div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); padding: 15px; border-radius: 12px; border: 1px solid #bbf7d0;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 8px; color: #059669;">‚úÖ C√¥ng Vi·ªác</h3>
                    <div class="stats-grid" style="grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div class="stat-card green" style="padding: 12px; margin: 0;">
                            <div class="stat-label">Ho√†n Th√†nh</div>
                            <div class="stat-value">52</div>
                            <div class="stat-change">59.8%</div>
                        </div>
                        <div class="stat-card red" style="padding: 12px; margin: 0;">
                            <div class="stat-label">Ch·∫≠m Ti·∫øn ƒê·ªô</div>
                            <div class="stat-value">7</div>
                            <div class="stat-change">8%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ALL CHARTS -->
            <div style="margin-bottom: 15px;">
                <!-- ROW 1: 3 CHARTS -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                    <div class="chart-container">
                        <div class="chart-title">Nh√¢n S·ª± & L∆∞∆°ng Theo Th·ªùi Gian</div>
                        <div class="chart-wrapper">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Nh√¢n S·ª± Theo Ph√≤ng Ban</div>
                        <div class="chart-wrapper">
                            <canvas id="departmentChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Tuy·ªÉn D·ª•ng & Ngh·ªâ Vi·ªác</div>
                        <div class="chart-wrapper">
                            <canvas id="recruitmentChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- ROW 2: 2 CHARTS -->
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 0;">
                    <div class="chart-container">
                        <div class="chart-title">C√¥ng Vi·ªác & T·ª∑ L·ªá Ho√†n Th√†nh Theo Th·ªùi Gian</div>
                        <div class="chart-wrapper">
                            <canvas id="workTrendChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">T·ª∑ L·ªá Ho√†n Th√†nh Theo Ph√≤ng Ban</div>
                        <div class="chart-wrapper">
                            <canvas id="deptCompletionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE 2: NH√ÇN S·ª∞ -->
        <div id="page2" class="page">
            <h2 class="page-title">üë• T√¨nh H√¨nh Nh√¢n S·ª±</h2>

            <!-- STAT CARDS -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">T·ªïng S·ªë Nh√¢n S·ª±</div>
                    <div class="stat-value">245</div>
                    <div class="stat-change up">‚Üë +5</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-label">S·ªë Tuy·ªÉn M·ªõi</div>
                    <div class="stat-value">18</div>
                    <div class="stat-change">NƒÉm nay</div>
                </div>
                <div class="stat-card yellow">
                    <div class="stat-label">S·ªë K√Ω HƒêLD</div>
                    <div class="stat-value">15</div>
                    <div class="stat-change">NƒÉm nay</div>
                </div>
                <div class="stat-card red">
                    <div class="stat-label">S·ªë Ngh·ªâ Vi·ªác</div>
                    <div class="stat-value">5</div>
                    <div class="stat-change">T·ª∑ l·ªá: 2.5%</div>
                </div>
            </div>

            <!-- CHARTS GRID - 3 COLUMNS -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                <div class="chart-container">
                    <div class="chart-title">S·ªë Nh√¢n S·ª± Theo Th·ªùi Gian</div>
                    <div class="chart-wrapper">
                        <canvas id="staffTrendChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Nh√¢n S·ª± Theo Ph√≤ng Ban</div>
                    <div id="treemap-container" style="padding: 15px; height: 250px; position: relative;">
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Nh√¢n S·ª± Theo Ph√≤ng Ban & Th√¢m Ni√™n</div>
                    <div id="seniority-matrix" style="padding: 15px; display: flex; align-items: center; justify-content: center; overflow-y: auto;">
                    </div>
                </div>
            </div>

            <!-- RECRUITMENT & SEPARATION SECTION -->
            <h3 style="font-size: 18px; font-weight: 700; margin-top: 20px; margin-bottom: 15px; color: #1f2937;">Tuy·ªÉn D·ª•ng & Ngh·ªâ Vi·ªác</h3>
            
            <!-- 4 CHARTS IN 2 ROWS -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
                <div class="chart-container">
                    <div class="chart-title">Tuy·ªÉn D·ª•ng Theo Th·ªùi Gian</div>
                    <div class="chart-wrapper" style="height: 340px;">
                        <canvas id="recruitmentTrendChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Ngh·ªâ Vi·ªác Theo Th·ªùi Gian</div>
                    <div class="chart-wrapper" style="height: 340px;">
                        <canvas id="separationTrendChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Tuy·ªÉn D·ª•ng & Ngh·ªâ Vi·ªác Theo Ph√≤ng Ban</div>
                    <div class="chart-wrapper" style="height: 400px;">
                        <canvas id="recruitSeparationByDeptChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">TOP 5 L√ç DO NGH·ªà VI·ªÜC</div>
                    <div class="chart-wrapper" style="height: 340px;">
                        <canvas id="reasonsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- GROUP 4: DETAILED TABLE -->
            <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 0;">
                <div class="chart-container">
                    <div class="chart-title">Chi Ti·∫øt Nh√¢n S·ª± Theo Ph√≤ng Ban</div>
                    <div style="overflow-x: auto; padding: 15px;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <thead>
                                <tr style="background: #f9fafb;">
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ph√≤ng Ban / V·ªã Tr√≠</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">T·ªïng NV</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Tuy·ªÉn M·ªõi</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ngh·ªâ Vi·ªác</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">C√≤n Tuy·ªÉn</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">T·ª∑ L·ªá (%) </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-group="dept-it" class="parent-row">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600;">
                                        <span class="toggle-node" data-target="dept-it" style="cursor: pointer; margin-right: 8px;">+</span>
                                        H√†nh ch√≠nh nh√¢n s·ª±
                                    </td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 600;">65</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 600;">8</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #ef4444; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b; font-weight: 600;">3</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">3.1%</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-it">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ Developer</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">35</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">5</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-it">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ DevOps</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-it">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #6b7280;">‚îî‚îÄ QA/Tester</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #f59e0b;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">-</td>
                                </tr>
                                <tr data-group="dept-sales" class="parent-row">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600;">
                                        <span class="toggle-node" data-target="dept-sales" style="cursor: pointer; margin-right: 8px;">+</span>
                                        MnR
                                    </td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 600;">55</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 600;">5</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #ef4444; font-weight: 600;">1</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">1.8%</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-sales">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ Sale Executive</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">40</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">4</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-sales">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #6b7280;">‚îî‚îÄ Account Manager</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #f59e0b;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">-</td>
                                </tr>
                                <tr data-group="dept-hr" class="parent-row" style="background: #f9fafb;">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600;">
                                        <span class="toggle-node" data-target="dept-hr" style="cursor: pointer; margin-right: 8px;">+</span>
                                        Qu·∫£n l√Ω r·ªóng
                                    </td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 600;">40</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 600;">3</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #ef4444; font-weight: 600;">0</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b; font-weight: 600;">1</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">0%</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-hr">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ HR Specialist</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">25</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-hr">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #6b7280;">‚îî‚îÄ Admin</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #f59e0b;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">-</td>
                                </tr>
                                <tr data-group="dept-fin" class="parent-row">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600;">
                                        <span class="toggle-node" data-target="dept-fin" style="cursor: pointer; margin-right: 8px;">+</span>
                                        K·∫ø to√°n - T√†i ch√≠nh
                                    </td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 600;">50</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #ef4444; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">4%</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-fin">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ Accountant</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">35</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">2</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-fin">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #6b7280;">‚îî‚îÄ Financial Analyst</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px; color: #f59e0b;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #f9fafb;" data-group="dept-mkt" class="parent-row">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600;">
                                        <span class="toggle-node" data-target="dept-mkt" style="cursor: pointer; margin-right: 8px;">+</span>
                                        Khai th√°c
                                    </td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600;">35</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #10b981; font-weight: 600;">2</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #ef4444; font-weight: 600;">1</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #f59e0b; font-weight: 600;">1</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb;">2.9%</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-mkt">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #6b7280;">‚îî‚îÄ Content Creator</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">20</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #ef4444;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px; color: #f59e0b;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #fafbfc; display: none;" data-parent="dept-mkt">
                                    <td style="padding: 8px 10px 8px 30px; border-bottom: 2px solid #e5e7eb; font-size: 12px; color: #6b7280;">‚îî‚îÄ Digital Marketing</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-size: 12px;">15</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-size: 12px; color: #10b981;">1</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-size: 12px; color: #ef4444;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-size: 12px; color: #f59e0b;">0</td>
                                    <td style="padding: 8px 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-size: 12px;">-</td>
                                </tr>
                                <tr style="background: #e8f5e9; font-weight: 600;">
                                    <td style="padding: 10px; border-bottom: 1px solid #e5e7eb;">T·ªîNG</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">245</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">18</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">5</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">9</td>
                                    <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb;">2.5%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE 3: L∆Ø∆†NG -->
        <div id="page3" class="page">
            <h2 class="page-title">üí∞ Qu·∫£n L√Ω L∆∞∆°ng</h2>

            <!-- GAUGE CHART & STAT CARDS -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div class="chart-container" style="padding: 10px;">
                    <div class="chart-title" style="font-size: 12px; margin-bottom: 6px;">T·ªïng L∆∞∆°ng & Ng√¢n S√°ch</div>
                    <div style="height: 110px; position: relative; padding-top: 8px;">
                        <canvas id="salaryBudgetGauge"></canvas>
                        <div style="position: absolute; bottom: 12px; left: 0; right: 0; text-align: center; font-size: 11px; color: #1f2937;">
                            <div style="font-weight: 700; font-size: 18px; color: #10b981;">92.3%</div>
                            <div style="font-weight: 600; margin-top: 2px; font-size: 10px;">1,200M / 1,300M</div>
                        </div>
                    </div>
                </div>
                <div class="stat-card" style="display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 12px 10px;">
                    <div class="stat-label" style="text-align: center; margin-bottom: 4px; font-size: 9px;">S·ªê NH√ÇN S·ª∞</div>
                    <div class="stat-value" style="font-size: 28px; margin-bottom: 2px;">245</div>
                    <div class="stat-change up" style="text-align: center; font-size: 9px;">+5 so v·ªõi th√°ng tr∆∞·ªõc</div>
                </div>
                <div class="stat-card" style="display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 12px 10px;">
                    <div class="stat-label" style="text-align: center; margin-bottom: 4px; font-size: 9px;">TRUNG B√åNH L∆Ø∆†NG/NV</div>
                    <div class="stat-value" style="font-size: 28px; margin-bottom: 2px;">4.9M</div>
                    <div class="stat-change up" style="text-align: center; font-size: 9px;">TƒÉng 2.1% so v·ªõi T1</div>
                </div>
            </div>

            <!-- ROW 1: CHARTS -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
                <div class="chart-container">
                    <div class="chart-title">1. L∆∞∆°ng Theo Th·ªùi Gian</div>
                    <div class="chart-wrapper" style="height: 300px;">
                        <canvas id="salaryTrendChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">2. L∆∞∆°ng Theo Ph√≤ng Ban</div>
                    <div class="chart-wrapper" style="height: 300px;">
                        <canvas id="salaryByDeptChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ROW 2: STRUCTURE & HEATMAP -->
            <div style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 15px; margin-bottom: 15px;">
                <div class="chart-container">
                    <div class="chart-title">3. C∆° C·∫•u L∆∞∆°ng</div>
                    <div class="chart-wrapper" style="height: 340px;">
                        <canvas id="salaryStructureChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">4. Heatmap Ph√¢n B·ªï Theo Ph√≤ng Ban & Th√°ng</div>
                    <div style="padding: 15px;">
                        <div style="display: flex; gap: 8px; margin-bottom: 15px; justify-content: center;">
                            <button class="heatmap-toggle-btn active" data-metric="salary" style="padding: 8px 16px; border: 2px solid #2563eb; background: #2563eb; color: white; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;">L∆∞∆°ng (Tri·ªáu)</button>
                            <button class="heatmap-toggle-btn" data-metric="staff" style="padding: 8px 16px; border: 2px solid #e5e7eb; background: white; color: #6b7280; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;">Nh√¢n S·ª±</button>
                            <button class="heatmap-toggle-btn" data-metric="avgCost" style="padding: 8px 16px; border: 2px solid #e5e7eb; background: white; color: #6b7280; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;">TB/NV (Tri·ªáu)</button>
                        </div>
                        <div id="salary-heatmap" style="overflow-x: auto;"></div>
                    </div>
                </div>
            </div>

            <!-- DETAILED TABLE -->
            <div class="chart-container">
                <div class="chart-title">5. B·∫£ng K√™ Chi Ti·∫øt Theo Ph√≤ng Ban</div>
                <div style="overflow-x: auto; padding: 15px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead>
                            <tr style="background: #f9fafb;">
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ph√≤ng Ban</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">T·ªïng NV</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">L∆∞∆°ng C∆° B·∫£n</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Th∆∞·ªüng</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ph·ª• C·∫•p</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">T·ªïng L∆∞∆°ng</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">TB/NV</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #4b5563;">+/- NƒÉm Tr∆∞·ªõc</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: linear-gradient(90deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.02) 100%); border-left: 3px solid #10b981;">
                                <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600; color: #047857;">H√†nh ch√≠nh nh√¢n s·ª±</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #2563eb; font-weight: 600;">65</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #059669;">280M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b;">42M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #8b5cf6;">26M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 700; color: #047857; background: #f0fdf4;">348M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #1d4ed8;">5.4M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+8.2%</td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(245,158,11,0.08) 0%, rgba(245,158,11,0.02) 100%); border-left: 3px solid #f59e0b;">
                                <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600; color: #c2410c;">MnR</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #2563eb; font-weight: 600;">55</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #059669;">220M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b;">55M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #8b5cf6;">22M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 700; color: #c2410c; background: #fffbeb;">297M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #1d4ed8;">5.4M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+12.5%</td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(168,85,247,0.08) 0%, rgba(168,85,247,0.02) 100%); border-left: 3px solid #a855f7;">
                                <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600; color: #7c3aed;">Qu·∫£n l√Ω r·ªóng</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #2563eb; font-weight: 600;">40</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #059669;">150M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b;">18M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #8b5cf6;">12M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 700; color: #7c3aed; background: #faf5ff;">180M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #1d4ed8;">4.5M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+5.3%</td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(37,99,235,0.08) 0%, rgba(37,99,235,0.02) 100%); border-left: 3px solid #2563eb;">
                                <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600; color: #1e40af;">K·∫ø to√°n - T√†i ch√≠nh</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #2563eb; font-weight: 600;">50</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #059669;">200M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b;">25M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #8b5cf6;">15M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 700; color: #1e40af; background: #eff6ff;">240M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #1d4ed8;">4.8M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+6.7%</td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(20,184,166,0.08) 0%, rgba(20,184,166,0.02) 100%); border-left: 3px solid #14b8a6;">
                                <td style="padding: 10px; border-bottom: 1px solid #e5e7eb; font-weight: 600; color: #0f766e;">Khai th√°c</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #2563eb; font-weight: 600;">20</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #059669;">60M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #f59e0b;">12M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #8b5cf6;">5M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; font-weight: 700; color: #0f766e; background: #f0fdfa;">77M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #1d4ed8;">3.9M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+8.5%</td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(236,72,153,0.08) 0%, rgba(236,72,153,0.02) 100%); border-left: 3px solid #ec4899;">
                                <td style="padding: 10px; border-bottom: 2px solid #e5e7eb; font-weight: 600; color: #be185d;">T·ªï Th∆∞∆°ng V·ª•</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #2563eb; font-weight: 600;">15</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #059669;">45M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #f59e0b;">9M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #8b5cf6;">4M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; font-weight: 700; color: #be185d; background: #fdf2f8;">58M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #1d4ed8;">3.9M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 2px solid #e5e7eb; color: #10b981; font-weight: 700; font-size: 14px;">+11.2%</td>
                            </tr>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; box-shadow: 0 2px 8px rgba(102,126,234,0.3);">
                                <td style="padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.3);">T·ªîNG</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3); font-weight: 700;">245</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3);">955M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3);">161M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3);">84M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3); font-weight: 700; background: rgba(255,255,255,0.15);">1,200M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3);">4.9M</td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.3); font-weight: 700; font-size: 14px;">+8.5%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- PAGE 4: THEO D√ïI C√îNG VI·ªÜC -->
        <div id="page4" class="page">
            <h2 class="page-title">‚úÖ Theo D√µi C√¥ng Vi·ªác</h2>

            <!-- Row 1: Charts 1-2-3 -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px;">
                <!-- Chart 1: Work Count & Completion Rate Over Time -->
                <div class="chart-container" style="margin: 0;">
                    <div class="chart-title">1. S·ªë L∆∞·ª£ng & T·ª∑ L·ªá Ho√†n Th√†nh C√¥ng Vi·ªác Theo Th·ªùi Gian</div>
                    <div class="chart-wrapper">
                        <canvas id="workTrendChart4"></canvas>
                    </div>
                </div>

                <!-- Chart 2: Completion Rate by Department with M-o-M Comparison -->
                <div class="chart-container" style="margin: 0;">
                    <div class="chart-title">2. T·ª∑ L·ªá Ho√†n Th√†nh Theo Ph√≤ng Ban</div>
                    <div class="chart-wrapper">
                        <canvas id="deptCompletionChart4"></canvas>
                    </div>
                </div>

                    <div class="chart-container" style="margin: 0;">
                    <div class="chart-title">3. Ph√¢n B·ªï C√¥ng Vi·ªác: M·ª©c ƒê·ªô ∆Øu Ti√™n √ó Tr·∫°ng Th√°i</div>
                <div style="padding: 20px;">
                    <table style="width: 100%; border-collapse: collapse; text-align: center;">
                        <thead>
                            <tr style="background: #f9fafb;">
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #4b5563;">M·ª©c ƒê·ªô</th>
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ch∆∞a B·∫Øt ƒê·∫ßu</th>
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #4b5563;">ƒêang Th·ª±c Hi·ªán</th>
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ho√†n Th√†nh</th>
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #4b5563;">Ch·∫≠m Ti·∫øn ƒê·ªô</th>
                                <th style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600; color: #fff; background: #667eea;">T·ªïng</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e5e7eb; font-weight: 600; background: #fee2e2; font-size: 12px;">Cao</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #dbeafe; font-size: 14px; font-weight: 600; color: #1e40af;">8</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #93c5fd; font-size: 14px; font-weight: 600; color: #1e3a8a;">15</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #60a5fa; font-size: 14px; font-weight: 600; color: #1e3a8a;">22</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #3b82f6; font-size: 14px; font-weight: 600; color: white;">5</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #e0e7ff; font-size: 14px; font-weight: 600; color: #4f46e5;">50</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e5e7eb; font-weight: 600; background: #fef9c3; font-size: 12px;">Trung B√¨nh</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #dbeafe; font-size: 14px; font-weight: 600; color: #1e40af;">12</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #93c5fd; font-size: 14px; font-weight: 600; color: #1e3a8a;">18</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #60a5fa; font-size: 14px; font-weight: 600; color: #1e3a8a;">28</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #3b82f6; font-size: 14px; font-weight: 600; color: white;">3</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #e0e7ff; font-size: 14px; font-weight: 600; color: #4f46e5;">61</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e5e7eb; font-weight: 600; background: #dcfce7; font-size: 12px;">Th·∫•p</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #dbeafe; font-size: 14px; font-weight: 600; color: #1e40af;">10</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #93c5fd; font-size: 14px; font-weight: 600; color: #1e3a8a;">14</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #60a5fa; font-size: 14px; font-weight: 600; color: #1e3a8a;">35</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #3b82f6; font-size: 14px; font-weight: 600; color: white;">2</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; background: #e0e7ff; font-size: 14px; font-weight: 600; color: #4f46e5;">61</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e5e7eb; font-weight: 600; font-size: 12px;">T·ªïng</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; font-size: 14px; font-weight: 600; color: #4b5563;">30</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; font-size: 14px; font-weight: 600; color: #4b5563;">47</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; font-size: 14px; font-weight: 600; color: #4b5563;">85</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; font-size: 14px; font-weight: 600; color: #4b5563;">10</td>
                                <td style="padding: 12px; border: 1px solid #e5e7eb; font-size: 14px; font-weight: 600; color: #4b5563;">172</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                </div>
            </div>

            <!-- Row 2: Charts 4-5 -->
            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 20px;">
                <!-- Chart 4: Stacked Bar for Backlog + New Work -->
                <div class="chart-container" style="margin: 0;">
                <div class="chart-title">4. K·∫ø Ho·∫°ch C√¥ng Vi·ªác K·ª≥ T·ªõi: T·ªìn K·ª≥ Tr∆∞·ªõc + M·ªõi Ph√°t Sinh</div>
                <div class="chart-wrapper">
                    <canvas id="workPlanChart"></canvas>
                </div>
                </div>

                <!-- Chart 5: Detailed Work Task Table -->
                <div class="chart-container" style="margin: 0;">
                <div class="chart-title">5. B·∫£ng Chi Ti·∫øt C√¥ng Vi·ªác Tr·ªçng T√¢m</div>
                <div style="overflow-x: auto; padding: 15px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 12px; text-align: left; font-weight: 600;">T√™n C√¥ng Vi·ªác</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Ph√≤ng Ban</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">∆Øu Ti√™n</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Tr·∫°ng Th√°i</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Ng∆∞·ªùi Ph·ª• Tr√°ch</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">H·∫°n Ch√≥t</th>
                                <th style="padding: 12px; text-align: center; font-weight: 600;">Ti·∫øn ƒê·ªô</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: linear-gradient(90deg, rgba(239,68,68,0.05) 0%, rgba(239,68,68,0.01) 100%); border-left: 3px solid #ef4444;">
                                <td style="padding: 10px; font-weight: 600;">Tri·ªÉn Khai ERP System</td>
                                <td style="padding: 10px; text-align: center; color: #2563eb;">IT</td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef2f2; color: #dc2626; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">CAO</span></td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef9c3; color: #a16207; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">ƒêang L√†m</span></td>
                                <td style="padding: 10px; text-align: center;">Nguy·ªÖn VƒÉn A</td>
                                <td style="padding: 10px; text-align: center; color: #ef4444; font-weight: 600;">30/05/2026</td>
                                <td style="padding: 10px; text-align: center;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div style="flex: 1; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                            <div style="width: 80%; height: 100%; background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);"></div>
                                        </div>
                                        <span style="font-weight: 600; color: #2563eb;">80%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(245,158,11,0.05) 0%, rgba(245,158,11,0.01) 100%); border-left: 3px solid #f59e0b;">
                                <td style="padding: 10px; font-weight: 600;">ƒê√†o T·∫°o L√£nh ƒê·∫°o 2026</td>
                                <td style="padding: 10px; text-align: center; color: #7c3aed;">Nh√¢n s·ª±</td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef9c3; color: #a16207; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">TRUNG B√åNH</span></td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef9c3; color: #a16207; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">ƒêang L√†m</span></td>
                                <td style="padding: 10px; text-align: center;">Tr·∫ßn Th·ªã B</td>
                                <td style="padding: 10px; text-align: center; color: #64748b;">30/06/2026</td>
                                <td style="padding: 10px; text-align: center;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div style="flex: 1; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                            <div style="width: 60%; height: 100%; background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);"></div>
                                        </div>
                                        <span style="font-weight: 600; color: #f59e0b;">60%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(239,68,68,0.05) 0%, rgba(239,68,68,0.01) 100%); border-left: 3px solid #ef4444;">
                                <td style="padding: 10px; font-weight: 600;">C·∫Øt Gi·∫£m Chi Ph√≠ V·∫≠n H√†nh</td>
                                <td style="padding: 10px; text-align: center; color: #059669;">H·∫° t·∫ßng</td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef2f2; color: #dc2626; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">CAO</span></td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fee2e2; color: #dc2626; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">Ch·∫≠m Ti·∫øn ƒê·ªô</span></td>
                                <td style="padding: 10px; text-align: center;">L√™ VƒÉn C</td>
                                <td style="padding: 10px; text-align: center; color: #ef4444; font-weight: 600;">31/05/2026</td>
                                <td style="padding: 10px; text-align: center;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div style="flex: 1; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                            <div style="width: 45%; height: 100%; background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);"></div>
                                        </div>
                                        <span style="font-weight: 600; color: #ef4444;">45%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr style="background: linear-gradient(90deg, rgba(16,185,129,0.05) 0%, rgba(16,185,129,0.01) 100%); border-left: 3px solid #10b981;">
                                <td style="padding: 10px; font-weight: 600;">Ph√°t Tri·ªÉn S·∫£n Ph·∫©m M·ªõi</td>
                                <td style="padding: 10px; text-align: center; color: #0ea5e9;">An ninh</td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef2f2; color: #dc2626; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">CAO</span></td>
                                <td style="padding: 10px; text-align: center;"><span style="background: #fef9c3; color: #a16207; padding: 4px 12px; border-radius: 12px; font-weight: 600; font-size: 11px;">ƒêang L√†m</span></td>
                                <td style="padding: 10px; text-align: center;">Ph·∫°m Th·ªã D</td>
                                <td style="padding: 10px; text-align: center; color: #64748b;">15/04/2026</td>
                                <td style="padding: 10px; text-align: center;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div style="flex: 1; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                            <div style="width: 90%; height: 100%; background: linear-gradient(90deg, #10b981 0%, #059669 100%);"></div>
                                        </div>
                                        <span style="font-weight: 600; color: #10b981;">90%</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                </div>
            </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìñ H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng</h2>
                <button class="modal-close" onclick="closeHelpModal()">‚úï</button>
            </div>

            <h3 style="color: #2563eb; font-size: 18px; margin: 20px 0 15px 0; padding-bottom: 12px; border-bottom: 2px solid #bfdbfe;">PH·∫¶N 1: N·ªòI DUNG C·ªêT L√ïI</h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                <div style="background: #f0f1ff; border-left: 5px solid #2563eb; padding: 18px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #2563eb; margin-bottom: 8px;">üìà TRANG 1 - T·ªîNG QUAN</div>
                    <div style="color: #6b7280; font-size: 14px; line-height: 1.6;">Xem t·ªïng s·ªë nh√¢n s·ª±, tuy·ªÉn d·ª•ng, l∆∞∆°ng, c√¥ng vi·ªác v√† hi·ªáu su·∫•t c√°c ph√≤ng ban</div>
                </div>
                <div style="background: #f0f1ff; border-left: 5px solid #2563eb; padding: 18px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #2563eb; margin-bottom: 8px;">üë• TRANG 2 - NH√ÇN S·ª∞</div>
                    <div style="color: #6b7280; font-size: 14px; line-height: 1.6;">Danh s√°ch nh√¢n vi√™n theo ph√≤ng ban, click ƒë·ªÉ m·ªü r·ªông/thu g·ªçn xem chi ti·∫øt</div>
                </div>
                <div style="background: #f0f1ff; border-left: 5px solid #2563eb; padding: 18px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #2563eb; margin-bottom: 8px;">üí∞ TRANG 3 - L∆Ø∆†NG</div>
                    <div style="color: #6b7280; font-size: 14px; line-height: 1.6;">Gauge ng√¢n s√°ch, xu h∆∞·ªõng l∆∞∆°ng, heatmap l∆∞∆°ng theo ph√≤ng, b·ªô l·ªçc t∆∞∆°ng t√°c</div>
                </div>
                <div style="background: #f0f1ff; border-left: 5px solid #2563eb; padding: 18px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #2563eb; margin-bottom: 8px;">‚úÖ TRANG 4 - C√îNG VI·ªÜC</div>
                    <div style="color: #6b7280; font-size: 14px; line-height: 1.6;">5 bi·ªÉu ƒë·ªì c√¥ng vi·ªác, heatmap ∆∞u ti√™n, b·∫£ng chi ti·∫øt, t·ªìn k·ª≥ c√¥ng vi·ªác</div>
                </div>
            </div>

            <div style="margin-top: 30px; margin-bottom: 30px;">
                <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <thead>
                        <tr style="background: #2563eb; color: white;">
                            <th style="padding: 12px; text-align: left; font-weight: 600;">Trang</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600;">M·ª•c ƒê√≠ch</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600;">C√¥ng C·ª• Ch√≠nh</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600;">D·ªØ Li·ªáu Ch√≠nh</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid #e5e7eb;">
                            <td style="padding: 12px; color: #374151; font-weight: 600;">T·ªïng Quan</td>
                            <td style="padding: 12px; color: #6b7280;">C√°i nh√¨n t·ªïng qu√°t</td>
                            <td style="padding: 12px; color: #6b7280;">KPI Cards, Bi·ªÉu ƒë·ªì</td>
                            <td style="padding: 12px; color: #6b7280;">T·ªïng s·ªë, xu h∆∞·ªõng</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                            <td style="padding: 12px; color: #374151; font-weight: 600;">Nh√¢n S·ª±</td>
                            <td style="padding: 12px; color: #6b7280;">Qu·∫£n l√Ω nh√¢n vi√™n</td>
                            <td style="padding: 12px; color: #6b7280;">B·∫£ng m·ªü r·ªông, L·ªçc</td>
                            <td style="padding: 12px; color: #6b7280;">T√™n, ch·ª©c v·ª•, ph√≤ng</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb;">
                            <td style="padding: 12px; color: #374151; font-weight: 600;">L∆∞∆°ng</td>
                            <td style="padding: 12px; color: #6b7280;">Qu·∫£n l√Ω chi ph√≠</td>
                            <td style="padding: 12px; color: #6b7280;">Gauge, Heatmap</td>
                            <td style="padding: 12px; color: #6b7280;">Ng√¢n s√°ch, xu h∆∞·ªõng</td>
                        </tr>
                        <tr style="background: #f9fafb;">
                            <td style="padding: 12px; color: #374151; font-weight: 600;">C√¥ng Vi·ªác</td>
                            <td style="padding: 12px; color: #6b7280;">Theo d√µi ti·∫øn ƒë·ªô</td>
                            <td style="padding: 12px; color: #6b7280;">5 Bi·ªÉu ƒë·ªì, Heatmap</td>
                            <td style="padding: 12px; color: #6b7280;">% ho√†n th√†nh, t·ªìn k·ª≥</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: #2563eb; font-size: 18px; margin: 20px 0 15px 0; padding-bottom: 12px; border-bottom: 2px solid #bfdbfe;">PH·∫¶N 2: LU·ªíNG B√ÅO C√ÅO & H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG</h3>

            <div style="background: #f0f1ff; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <div style="font-weight: 700; color: #2563eb; margin-bottom: 15px;">üìã C√°c b∆∞·ªõc s·ª≠ d·ª•ng:</div>
                <ol style="margin-left: 25px; color: #374151; font-size: 15px; line-height: 1.8;">
                    <li>B·∫Øt ƒë·∫ßu t·ª´ Trang 1 (T·ªïng Quan) ƒë·ªÉ xem t·ªïng qu√°t to√†n h·ªá th·ªëng</li>
                    <li>Trang 2 (Nh√¢n S·ª±): Click t√™n ph√≤ng ban ƒë·ªÉ xem danh s√°ch nh√¢n vi√™n chi ti·∫øt</li>
                    <li>Trang 3 (L∆∞∆°ng): D√πng b·ªô l·ªçc ƒë·ªÉ xem l∆∞∆°ng t·ª´ng ph√≤ng v√† so s√°nh</li>
                    <li>Trang 4 (C√¥ng Vi·ªác): Theo d√µi xu h∆∞·ªõng, ph√¢n b·ªï c√¥ng vi·ªác v√† t·ªìn k·ª≥</li>
                </ol>
            </div>

            <div style="background: #fef3c7; border-left: 5px solid #f59e0b; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <div style="font-weight: 700; color: #b45309; margin-bottom: 15px;">üí° L∆ØU √ù QUAN TR·ªåNG:</div>
                <ul style="margin-left: 25px; color: #92400e; font-size: 15px; line-height: 1.8;">
                    <li><strong>Bi·ªÉu ƒë·ªì t∆∞∆°ng t√°c:</strong> Di chu·ªôt l√™n ƒë·ªÉ xem tooltip chi ti·∫øt</li>
                    <li><strong>Trang Nh√¢n S·ª±:</strong> Click d√≤ng ph√≤ng ban ƒë·ªÉ m·ªü/ƒë√≥ng danh s√°ch</li>
                    <li><strong>Trang L∆∞∆°ng:</strong> B·ªô l·ªçc ph√≤ng t∆∞∆°ng t√°c v·ªõi heatmap t·ª± ƒë·ªông</li>
                    <li><strong>Trang C√¥ng Vi·ªác:</strong> Hover ƒë·ªÉ so s√°nh % ho√†n th√†nh v·ªõi th√°ng tr∆∞·ªõc</li>
                    <li><strong>B·∫£ng d·ªØ li·ªáu:</strong> Cu·ªôn ngang/d·ªçc ƒë·ªÉ xem ƒë·∫ßy ƒë·ªß th√¥ng tin</li>
                </ul>
            </div>

            <h3 style="color: #2563eb; font-size: 18px; margin: 30px 0 15px 0; padding-bottom: 12px; border-bottom: 2px solid #bfdbfe;">üìå C√ÇU H·ªéI TH∆Ø·ªúNG G·∫∂P THEO TRANG</h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div style="background: #eff6ff; border-left: 5px solid #2563eb; padding: 15px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #2563eb; margin-bottom: 10px;">üìà TRANG 1 - T·ªîNG QUAN</div>
                    <ul style="margin: 0; padding-left: 20px; color: #374151; font-size: 13px; line-height: 1.6;">
                        <li><strong>L√†m sao xem t·ªïng s·ªë nh√¢n s·ª± hi·ªán t·∫°i?</strong> ‚Üí Xem KPI card "T·ªïng S·ªë Nh√¢n S·ª±" ·ªü ƒë·∫ßu trang</li>
                        <li><strong>Bi·ªÉu ƒë·ªì n√†o cho th·∫•y xu h∆∞·ªõng l∆∞∆°ng?</strong> ‚Üí Chart "L∆∞∆°ng & T·ª∑ L·ªá" ·ªü h√†ng ƒë·∫ßu</li>
                        <li><strong>C√°ch so s√°nh % ho√†n th√†nh c√¥ng vi·ªác gi·ªØa c√°c th√°ng?</strong> ‚Üí D√πng Chart "C√¥ng Vi·ªác & T·ª∑ L·ªá Ho√†n Th√†nh"</li>
                    </ul>
                </div>

                <div style="background: #f0fdf4; border-left: 5px solid #10b981; padding: 15px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #10b981; margin-bottom: 10px;">üë• TRANG 2 - NH√ÇN S·ª∞</div>
                    <ul style="margin: 0; padding-left: 20px; color: #374151; font-size: 13px; line-height: 1.6;">
                        <li><strong>L√†m sao xem danh s√°ch nh√¢n vi√™n t·ª´ng ph√≤ng?</strong> ‚Üí Click t√™n ph√≤ng ban ƒë·ªÉ m·ªü r·ªông</li>
                        <li><strong>B·∫£ng "Tuy·ªÉn D·ª•ng & Ngh·ªâ Vi·ªác" l√† g√¨?</strong> ‚Üí Th·ªëng k√™ nh√¢n vi√™n m·ªõi v√†o v√† ng∆∞·ªùi ngh·ªâ vi·ªác</li>
                        <li><strong>Heatmap "Nh√¢n S·ª± & Th√¢m Ni√™n" d√πng ƒë·ªÉ l√†m g√¨?</strong> ‚Üí Xem ph√¢n b·ªï nh√¢n vi√™n theo ph√≤ng v√† nƒÉm kinh nghi·ªám</li>
                    </ul>
                </div>

                <div style="background: #fffbeb; border-left: 5px solid #f59e0b; padding: 15px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #f59e0b; margin-bottom: 10px;">üí∞ TRANG 3 - L∆Ø∆†NG</div>
                    <ul style="margin: 0; padding-left: 20px; color: #374151; font-size: 13px; line-height: 1.6;">
                        <li><strong>Gauge chart l√† g√¨?</strong> ‚Üí Hi·ªÉn th·ªã t·ª∑ l·ªá % ng√¢n s√°ch l∆∞∆°ng ƒë√£ d√πng so v·ªõi t·ªïng</li>
                        <li><strong>Heatmap l∆∞∆°ng theo ph√≤ng d√πng ƒë·ªÉ l√†m g√¨?</strong> ‚Üí So s√°nh m·ª©c l∆∞∆°ng t·ªïng h·ª£p gi·ªØa c√°c ph√≤ng theo th√°ng</li>
                        <li><strong>L√†m sao bi·∫øt ph√≤ng n√†o c√≥ chi ph√≠ l∆∞∆°ng cao nh·∫•t?</strong> ‚Üí Xem b·∫£ng "Chi Ti·∫øt Theo Ph√≤ng Ban"</li>
                    </ul>
                </div>

                <div style="background: #fef2f2; border-left: 5px solid #ef4444; padding: 15px; border-radius: 8px;">
                    <div style="font-weight: 700; color: #ef4444; margin-bottom: 10px;">‚úÖ TRANG 4 - C√îNG VI·ªÜC</div>
                    <ul style="margin: 0; padding-left: 20px; color: #374151; font-size: 13px; line-height: 1.6;">
                        <li><strong>T·ª∑ l·ªá ho√†n th√†nh c√¥ng vi·ªác ƒë∆∞·ª£c t√≠nh nh∆∞ th·∫ø n√†o?</strong> ‚Üí (C√¥ng vi·ªác ho√†n th√†nh / T·ªïng c√¥ng vi·ªác) √ó 100%</li>
                        <li><strong>B·∫£ng "Ph√¢n B·ªï C√¥ng Vi·ªác" l√† g√¨?</strong> ‚Üí Th·ªëng k√™ s·ªë l∆∞·ª£ng c√¥ng vi·ªác theo ∆∞u ti√™n (Cao, TB, Th·∫•p) v√† tr·∫°ng th√°i</li>
                        <li><strong>Chart 4 "K·∫ø Ho·∫°ch C√¥ng Vi·ªác" d√πng ƒë·ªÉ l√†m g√¨?</strong> ‚Üí D·ª± b√°o c√¥ng vi·ªác k·ª≥ t·ªõi: t·ªìn k·ª≥ + m·ªõi ph√°t sinh</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
                </div>
            </div>
        </div>

    <script>
        // Help Modal Functions - defined first so they can be called
        function openHelpModal() {
            const helpModal = document.getElementById('helpModal');
            if (helpModal) {
                helpModal.classList.add('active');
            }
        }

        function closeHelpModal() {
            const helpModal = document.getElementById('helpModal');
            if (helpModal) {
                helpModal.classList.remove('active');
            }
        }

        // Auto-open help modal immediately when page loads
        function autoOpenHelpModal() {
            const helpModal = document.getElementById('helpModal');
            if (helpModal) {
                helpModal.classList.add('active');
            }
        }

        // Call immediately and also on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', autoOpenHelpModal);
        } else {
            autoOpenHelpModal();
        }

        // Navigation
        function showPage(pageId) {
            console.log('showPage called with:', pageId);
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));

            // Remove active from nav buttons, then set the one matching data-page
            const buttons = document.querySelectorAll('.nav-item');
            buttons.forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.nav-item[data-page="${pageId}"]`);

            const pageElement = document.getElementById(pageId);
            console.log('pageElement found:', pageElement);
            if (pageElement) {
                pageElement.classList.add('active');
            }

            if (activeBtn) {
                activeBtn.classList.add('active');
            }

            // Scroll to top of content
            const contentWrapper = document.querySelector('.content-inner');
            if (contentWrapper) {
                contentWrapper.scrollTop = 0;
            }
        }

        // Chart Colors
        const colors = {
            primary: '#2563eb',
            success: '#10b981',
            warning: '#f59e0b',
            danger: '#ef4444',
            info: '#0ea5e9'
        };

        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                datalabels: {
                    display: false  // Disable by default for other charts
                }
            }
        };

        // Enable data labels globally
        Chart.register(ChartDataLabels);
        
        // Don't set global defaults - will configure per chart instead

        // Toggle detail rows in department table
        const toggleNodes = document.querySelectorAll('.toggle-node');
        toggleNodes.forEach(node => {
            node.addEventListener('click', () => {
                const target = node.getAttribute('data-target');
                const rows = document.querySelectorAll(`[data-parent="${target}"]`);
                const isOpen = node.textContent.trim() === '‚àí';
                const nextState = !isOpen;

                node.textContent = nextState ? '‚àí' : '+';
                rows.forEach(row => {
                    row.style.display = nextState ? 'table-row' : 'none';
                });
            });
        });

        // PAGE 1 OVERVIEW CHARTS

        // Chart 1: Nh√¢n S·ª± & L∆∞∆°ng Theo Th·ªùi Gian (Combo)
        const ctx1 = document.getElementById('trendChart').getContext('2d');
        new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: ['T9', 'T10', 'T11', 'T12', 'T1', 'T2'],
                datasets: [
                    {
                        label: 'Nh√¢n S·ª±',
                        data: [210, 215, 220, 230, 240, 245],
                        backgroundColor: colors.primary,
                        yAxisID: 'y',
                        order: 2
                    },
                    {
                        label: 'Qu·ªπ L∆∞∆°ng (T·ªâ)',
                        data: [1050, 1070, 1090, 1100, 1120, 1200],
                        borderColor: colors.success,
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        type: 'line',
                        yAxisID: 'y1',
                        order: 1,
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: {
                    y: { position: 'left' },
                    y1: { position: 'right', grid: { drawOnChartArea: false } }
                }
            }
        });

        // Chart 2: Nh√¢n S·ª± Theo Ph√≤ng Ban
        const ctx2 = document.getElementById('departmentChart').getContext('2d');
        const deptData = [48, 42, 35, 52, 38];
        const totalDeptStaff = deptData.reduce((a, b) => a + b, 0);
        new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ['H√†nh ch√≠nh nh√¢n s·ª±', 'MnR', 'Qu·∫£n l√Ω r·ªóng', 'Khai th√°c', 'T√†i ch√≠nh k·∫ø to√°n'],
                datasets: [{
                    label: 'S·ªë Nh√¢n S·ª±',
                    data: deptData,
                    backgroundColor: colors.primary
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        ticks: {
                            callback: function(value) {
                                return value;
                            }
                        }
                    }
                }
            },
            plugins: [{
                afterDraw: function(chart) {
                    const ctx = chart.ctx;
                    const dataset = chart.data.datasets[0];
                    const yScale = chart.scales.y;
                    const xScale = chart.scales.x;
                    
                    dataset.data.forEach((value, index) => {
                        const percentage = ((value / totalDeptStaff) * 100).toFixed(1);
                        const barX = xScale.getPixelForValue(value / 2);
                        const barY = yScale.getPixelForValue(index);
                        
                        ctx.fillStyle = '#fff';
                        ctx.font = '13px Segoe UI';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(value + ' (' + percentage + '%)', barX, barY);
                    });
                }
            }]
        });

        // Chart 3: Tuy·ªÉn D·ª•ng & Ngh·ªâ Vi·ªác Theo Th·ªùi Gian
        const ctx3 = document.getElementById('recruitmentChart').getContext('2d');
        new Chart(ctx3, {
            type: 'line',
            data: {
                labels: ['T9', 'T10', 'T11', 'T12', 'T1', 'T2'],
                datasets: [
                    {
                        label: 'Tuy·ªÉn D·ª•ng',
                        data: [12, 15, 10, 18, 8, 10],
                        borderColor: colors.success,
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: colors.success
                    },
                    {
                        label: 'Ngh·ªâ Vi·ªác',
                        data: [3, 2, 4, 1, 2, 1],
                        borderColor: colors.danger,
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: colors.danger
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // Chart 4: C√¥ng Vi·ªác & T·ª∑ L·ªá Ho√†n Th√†nh Theo Th·ªùi Gian (Combo)
        const ctx4 = document.getElementById('workTrendChart').getContext('2d');
        new Chart(ctx4, {
            type: 'bar',
            data: {
                labels: ['T9', 'T10', 'T11', 'T12', 'T1', 'T2'],
                datasets: [
                    {
                        label: 'S·ªë L∆∞·ª£ng C√¥ng Vi·ªác',
                        data: [65, 68, 72, 78, 82, 85],
                        backgroundColor: '#fcd34d',
                        yAxisID: 'y',
                        order: 2
                    },
                    {
                        label: 'T·ª∑ L·ªá Ho√†n Th√†nh (%)',
                        data: [45, 48, 52, 55, 58, 59.8],
                        borderColor: '#60a5fa',
                        backgroundColor: 'rgba(96, 165, 250, 0.1)',
                        type: 'line',
                        yAxisID: 'y1',
                        order: 1,
                        fill: false,
                        tension: 0.4,
                        borderWidth: 3,
                        pointBackgroundColor: '#60a5fa',
                        pointBorderColor: '#fff',
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: {
                    y: { position: 'left' },
                    y1: { position: 'right', grid: { drawOnChartArea: false }, max: 100 }
                }
            }
        });

        // Chart 5: T·ª∑ L·ªá Ho√†n Th√†nh Theo Ph√≤ng Ban
        const ctx5 = document.getElementById('deptCompletionChart').getContext('2d');
        const completionData = [75, 65, 55, 70];
        const avgCompletion = (completionData.reduce((a, b) => a + b, 0) / completionData.length).toFixed(1);
        const barColors = completionData.map(val => val >= avgCompletion ? colors.success : colors.danger);
        
        new Chart(ctx5, {
            type: 'bar',
            data: {
                labels: ['Nh√¢n S·ª±', 'IT', 'An Ninh', 'Qu·∫£n L√Ω H·∫° T·∫ßng'],
                datasets: [{
                    label: 'T·ª∑ L·ªá Ho√†n Th√†nh (%)',
                    data: completionData,
                    backgroundColor: barColors
                },
                {
                    label: 'M·ª©c Trung B√¨nh',
                    data: [avgCompletion, avgCompletion, avgCompletion, avgCompletion],
                    type: 'line',
                    borderColor: '#fcd34d',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    fill: false,
                    tension: 0
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: { x: { max: 100 } }
            }
        });

        // PAGE 2: Personnel Charts
        // Chart 1: Staff Trend
        const ctx6 = document.getElementById('staffTrendChart').getContext('2d');
        new Chart(ctx6, {
            type: 'line',
            data: {
                labels: ['Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12', 'Th√°ng 1', 'Th√°ng 2'],
                datasets: [{
                    label: 'T·ªïng Nh√¢n S·ª±',
                    data: [220, 225, 235, 238, 242, 245],
                    borderColor: colors.primary,
                    backgroundColor: 'rgba(37, 99, 235, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: chartConfig
        });

        // Chart 2: Staff Breakdown Chart with SVG Tree (Financial style)
        const hierarchyContainer = document.getElementById('treemap-container');
        
        // Staff data structure
        const staffHierarchy = {
            name: 'T·ªïng nh√¢n s·ª±',
            value: 295,
            children: [
                {
                    name: 'Kh·ªëi VƒÉn Ph√≤ng',
                    value: 205,
                    children: [
                        { name: 'H√†nh Ch√≠nh', value: 40 },
                        { name: 'IT', value: 65 },
                        { name: 'H·∫° T·∫ßng', value: 50 },
                        { name: 'K·∫ø To√°n T√†i Ch√≠nh', value: 50 }
                    ]
                },
                {
                    name: 'Kh·ªëi S·∫£n Xu·∫•t',
                    value: 90,
                    children: [
                        { name: 'Kinh Doanh', value: 55 },
                        { name: 'Marketing', value: 35 }
                    ]
                }
            ]
        };

        const totalBreakdownStaff = staffHierarchy.value;

        // SVG Tree Builder
        function createStaffTree() {
            const nodeWidth = 240;
            const nodeHeight = 64;
            const horizontalGap = 60;
            const verticalGap = 24;
            const rootX = 20;
            const rootY = 150;
            
            let svgContent = '';
            let currentY = rootY - ((staffHierarchy.children.length - 1) * (nodeHeight + verticalGap)) / 2;
            
            // Draw connections first (behind nodes)
            staffHierarchy.children.forEach((block, idx) => {
                const blockY = currentY + idx * (nodeHeight + verticalGap);
                const startX = rootX + nodeWidth;
                const startY = rootY + nodeHeight / 2;
                const endX = rootX + nodeWidth + horizontalGap;
                const endY = blockY + nodeHeight / 2;
                const controlX = startX + horizontalGap / 2;
                
                svgContent += `<path class="link" stroke="#cbd5f5" fill="none" stroke-width="1.8" d="M${startX},${startY} C${controlX},${startY} ${controlX},${endY} ${endX},${endY}"></path>`;
            });
            
            // Draw root node
            const rootBarWidth = 120;
            svgContent += `
                <g class="node" transform="translate(${rootX},${rootY})" style="cursor: pointer;">
                    <rect x="0" y="0" width="${nodeWidth}" height="${nodeHeight}" rx="10" ry="10" 
                          fill="#ffffff" stroke="#e5e7eb" stroke-width="1.2" 
                          style="filter: drop-shadow(0px 1px 2px rgba(15, 23, 42, 0.1));"></rect>
                    <text x="14" y="26" font-size="14" font-weight="600" fill="#111827">${staffHierarchy.name}</text>
                    <text x="14" y="46" font-size="13" fill="#6b7280">${staffHierarchy.value} nh√¢n s·ª±</text>
                    <rect x="90" y="24" width="${rootBarWidth}" height="8" rx="6" ry="6" fill="#f3f4f6"></rect>
                    <rect class="bar" x="90" y="24" height="8" rx="6" ry="6" fill="#10b981" width="${rootBarWidth}"></rect>
                </g>
            `;
            
            // Draw block nodes
            currentY = rootY - ((staffHierarchy.children.length - 1) * (nodeHeight + verticalGap)) / 2;
            staffHierarchy.children.forEach((block, blockIdx) => {
                const blockY = currentY + blockIdx * (nodeHeight + verticalGap);
                const blockX = rootX + nodeWidth + horizontalGap;
                const blockPercent = (block.value / totalBreakdownStaff * 100).toFixed(0);
                const barWidth = (block.value / totalBreakdownStaff) * 120;
                const blockId = `svg-block-${blockIdx}`;
                
                svgContent += `
                    <g class="node" transform="translate(${blockX},${blockY})" style="cursor: pointer;" onclick="toggleSvgBlock('${blockId}')">
                        <rect x="0" y="0" width="${nodeWidth}" height="${nodeHeight}" rx="10" ry="10" 
                              fill="#ffffff" stroke="#e5e7eb" stroke-width="1.2" 
                              style="filter: drop-shadow(0px 1px 2px rgba(15, 23, 42, 0.1));"></rect>
                        <text x="14" y="26" font-size="14" font-weight="600" fill="#111827">${block.name}</text>
                        <text x="14" y="46" font-size="13" fill="#6b7280">${block.value} (${blockPercent}%)</text>
                        <rect x="95" y="28" width="115" height="8" rx="6" ry="6" fill="#f3f4f6"></rect>
                        <rect class="bar" x="95" y="28" height="8" rx="6" ry="6" fill="#10b981" width="${barWidth}"></rect>
                        <text x="225" y="22" text-anchor="end" font-size="16" fill="#9ca3af" id="${blockId}-icon">+</text>
                    </g>
                `;
            });
            
            return svgContent;
        }

        // Calculate SVG height
        const nodeHeight = 64;
        const verticalGap = 24;
        const svgHeight = staffHierarchy.children.length * (nodeHeight + verticalGap) + 120;
        
        // Build HTML with SVG tree
        let hierarchyHTML = `
            <div style="padding: 15px; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <!-- SVG Tree -->
                <svg width="100%" height="100%" viewBox="0 0 520 ${svgHeight}" preserveAspectRatio="xMidYMid meet" style="max-height: 280px; margin-bottom: 12px;">
                    ${createStaffTree()}
                </svg>
                
                <!-- Expandable Details Sections -->
                <div style="display: flex; flex-direction: column; gap: 10px;">
        `;
        
        // Build expandable detail sections for each block
        staffHierarchy.children.forEach((block, blockIdx) => {
            const blockId = `svg-block-${blockIdx}`;
            const blockPercent = (block.value / totalBreakdownStaff * 100).toFixed(1);
            
            hierarchyHTML += `
                <div id="${blockId}" style="display: none; background: #ffffff; border: 1px solid #e2e8f0; border-radius: 6px; padding: 14px;">
                    <div style="font-size: 11px; font-weight: 600; color: #64748b; margin-bottom: 12px; text-transform: uppercase;">
                        ${block.name} - Chi ti·∫øt ph√≤ng ban
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
            `;
            
            block.children.forEach(dept => {
                const deptPercent = (dept.value / block.value * 100).toFixed(1);
                const deptTotalPercent = (dept.value / totalBreakdownStaff * 100).toFixed(1);
                hierarchyHTML += `
                    <div style="
                        background: #f8fafc;
                        border-left: 4px solid #10b981;
                        border-radius: 6px;
                        padding: 12px 14px;
                        transition: all 0.2s ease;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    " class="dept-item-card">
                        <div>
                            <div style="font-size: 11px; font-weight: 600; color: #64748b; margin-bottom: 2px; text-transform: uppercase; letter-spacing: 0.3px;">${dept.name}</div>
                            <div style="display: flex; gap: 8px; font-size: 10px; color: #94a3b8;">
                                <span>${deptPercent}% kh·ªëi</span>
                                <span>‚Ä¢</span>
                                <span>${deptTotalPercent}% t·ªïng</span>
                            </div>
                        </div>
                        <div style="font-size: 26px; font-weight: 700; color: #1e293b;">${dept.value}</div>
                    </div>
                `;
            });
            
            hierarchyHTML += `
                    </div>
                </div>
            `;
        });
        
        hierarchyHTML += `
                </div>
            </div>
        `;
        
        hierarchyContainer.innerHTML = hierarchyHTML;
        
        // Toggle function for SVG blocks
        window.toggleSvgBlock = function(blockId) {
            const container = document.getElementById(blockId);
            const icon = document.getElementById(blockId + '-icon');
            
            if (container.style.display === 'none') {
                container.style.display = 'block';
                icon.textContent = '‚àí';
            } else {
                container.style.display = 'none';
                icon.textContent = '+';
            }
        };
        
        // Add hover effect for department cards
        setTimeout(() => {
            const deptCards = document.querySelectorAll('.dept-item-card');
            deptCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateX(3px)';
                    this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateX(0)';
                    this.style.boxShadow = '0 1px 2px rgba(0,0,0,0.05)';
                });
            });
        }, 100);
        
        // Add hover effects via style tag
        const hierarchyStyle = document.createElement('style');
        hierarchyStyle.textContent = `
            .dept-item-card {
                cursor: pointer;
            }
            .node:hover rect {
                stroke: #cbd5e1;
                stroke-width: 1.5;
            }
        `;
        document.head.appendChild(hierarchyStyle);

        // Chart 3: Heat Map Matrix (Seniority)
        const departments = ['H√†nh ch√≠nh nh√¢n s·ª±', 'MnR', 'Qu·∫£n l√Ω r·ªóng', 'K·∫ø to√°n - T√†i ch√≠nh', 'Khai th√°c', 'T·ªï Th∆∞∆°ng V·ª•'];
        const seniorityLevels = ['0-1 nƒÉm', '1-3 nƒÉm', '3-5 nƒÉm', '5+ nƒÉm'];
        const heatmapData = [
            [15, 18, 20, 12],
            [10, 15, 18, 12],
            [8, 12, 15, 5],
            [12, 16, 15, 7],
            [4, 6, 7, 3],
            [3, 4, 5, 3]
        ];

        // Create HTML matrix visualization with color gradient
        const matrixContainer = document.getElementById('seniority-matrix');
        const maxValue = Math.max(...heatmapData.flat());
        let matrixHTML = '<div style="width: 100%; font-size: 12px; font-family: Arial, sans-serif; border-collapse: collapse;">';
        
        // Header row
        matrixHTML += '<div style="display: grid; grid-template-columns: 120px repeat(4, 1fr); gap: 0;">';
        matrixHTML += '<div style="font-weight: 600; padding: 8px; text-align: center; border: 1px solid #e5e7eb; background: #f9fafb;"></div>';
        seniorityLevels.forEach(level => {
            matrixHTML += `<div style="font-weight: 600; padding: 8px; text-align: center; font-size: 11px; border: 1px solid #e5e7eb; background: #f9fafb;">${level}</div>`;
        });
        matrixHTML += '</div>';
        
        // Data rows
        heatmapData.forEach((row, deptIdx) => {
            const deptName = departments[deptIdx];
            matrixHTML += '<div style="display: grid; grid-template-columns: 120px repeat(4, 1fr); gap: 0;">';
            matrixHTML += `<div style="font-weight: 600; padding: 8px; text-align: right; font-size: 11px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; border: 1px solid #e5e7eb; background: #f9fafb;">${deptName}</div>`;
            row.forEach((value) => {
                const intensity = value / maxValue;
                const bgColor = `rgba(37, 99, 235, ${intensity * 0.7 + 0.1})`;
                const textColor = intensity > 0.5 ? '#fff' : '#1f2937';
                matrixHTML += `<div style="background: ${bgColor}; padding: 12px 8px; text-align: center; font-weight: 600; color: ${textColor}; border: 1px solid #e5e7eb; height: 40px; display: flex; align-items: center; justify-content: center;">${value}</div>`;
            });
            matrixHTML += '</div>';
        });
        matrixHTML += '</div>';
        matrixContainer.innerHTML = matrixHTML;

        // Chart 4: Recruitment Trend (with proposed target)
        const ctx10 = document.getElementById('recruitmentTrendChart').getContext('2d');
        const recruitmentLabels = ['Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12', 'Th√°ng 1', 'Th√°ng 2'];
        const recruitmentActual = [2, 3, 2, 4, 3, 4];
        const recruitmentProposed = [3, 3, 4, 4, 3, 4];
        // Calculate unfilled positions (proposed - actual)
        const recruitmentUnfilled = recruitmentProposed.map((val, idx) => val - recruitmentActual[idx]);
        
        // Calculate fulfillment percentage
        const recruitmentPercent = recruitmentActual.map((val, idx) => Math.round((val / recruitmentProposed[idx]) * 100));
        
        // Conditional colors: green if 100%, yellow if < 100%
        const recruitmentColors = recruitmentPercent.map(percent => percent >= 100 ? colors.success : colors.warning);
        
        new Chart(ctx10, {
            type: 'bar',
            data: {
                labels: recruitmentLabels,
                datasets: [{
                    label: 'Tuy·ªÉn D·ª•ng Th·ª±c T·∫ø',
                    data: recruitmentActual,
                    backgroundColor: recruitmentColors,
                    borderColor: recruitmentColors,
                    borderWidth: 0,
                    barPercentage: 0.6,
                    categoryPercentage: 0.8,
                    datalabels: {
                        display: true,
                        anchor: 'center',
                        align: 'center',
                        font: { weight: 'bold', size: 11 },
                        color: '#ffffff',
                        formatter: function(value, context) {
                            const idx = context.dataIndex;
                            const actual = recruitmentActual[idx];
                            const percent = recruitmentPercent[idx];
                            return actual + '\n' + percent + '%';
                        }
                    }
                },
                {
                    label: 'Ch∆∞a Tuy·ªÉn ƒê∆∞·ª£c',
                    data: recruitmentUnfilled,
                    backgroundColor: '#ffffff',
                    borderColor: '#d1d5db',
                    borderWidth: 2,
                    barPercentage: 0.6,
                    categoryPercentage: 0.8,
                    datalabels: {
                        display: false
                    }
                }]
            },
            plugins: [ChartDataLabels],
            options: {
                ...chartConfig,
                plugins: {
                    ...chartConfig.plugins,
                    datalabels: {
                        display: true
                    }
                },
                scales: {
                    y: {
                        ...chartConfig.scales.y,
                        stacked: true,
                        beginAtZero: true
                    },
                    x: {
                        ...chartConfig.scales.x,
                        stacked: true
                    }
                }
            }
        });

        // Chart 5: Separation Trend
        const ctx11 = document.getElementById('separationTrendChart').getContext('2d');
        new Chart(ctx11, {
            type: 'line',
            data: {
                labels: ['Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12', 'Th√°ng 1', 'Th√°ng 2'],
                datasets: [
                    {
                        label: 'NƒÉm Tr∆∞·ªõc',
                        data: [2, 1, 2, 1, 0, 2],
                        borderColor: '#d1d5db',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointBackgroundColor: '#d1d5db'
                    },
                    {
                        label: 'Ngh·ªâ Vi·ªác',
                        data: [1, 0, 1, 1, 1, 1],
                        borderColor: colors.danger,
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: colors.danger
                    }
                ]
            },
            options: {
                ...chartConfig,
                plugins: {
                    ...chartConfig.plugins,
                    legend: { display: true, position: 'bottom' }
                }
            }
        });

        // Chart 6: Recruitment vs Separation by Department (stacked horizontal bar from same origin)
        const ctx12 = document.getElementById('recruitSeparationByDeptChart').getContext('2d');
        const deptNames = ['H√†nh ch√≠nh nh√¢n s·ª±', 'MnR', 'Qu·∫£n l√Ω r·ªóng', 'K·∫ø to√°n - T√†i ch√≠nh', 'Khai th√°c', 'T·ªï Th∆∞∆°ng V·ª•'];
        const recruitmentByDept = [8, 5, 3, 2, 1, 1];
        const separationByDept = [2, 1, 0, 2, 1, 0];
        
        new Chart(ctx12, {
            type: 'bar',
            data: {
                labels: deptNames,
                datasets: [
                {
                    label: 'Tuy·ªÉn M·ªõi',
                    data: recruitmentByDept,
                    backgroundColor: colors.success,
                    barThickness: 25
                },
                {
                    label: 'Ngh·ªâ Vi·ªác',
                    data: separationByDept,
                    backgroundColor: colors.danger,
                    barThickness: 25
                }]
            },
            options: {
                ...chartConfig,
                indexAxis: 'y',
                scales: {
                    x: {
                        stacked: false,
                        beginAtZero: true,
                        max: 12
                    },
                    y: {
                        stacked: false
                    }
                },
                plugins: {
                    ...chartConfig.plugins,
                    legend: { display: true, position: 'top' },
                    datalabels: {
                        anchor: 'end',
                        align: 'end',
                        color: '#1f2937',
                        font: { weight: 'bold', size: 11 }
                    }
                },
                layout: {
                    padding: { left: 8, right: 40, top: 8, bottom: 8 }
                }
            }
        });

        // Chart 6.5: TOP 5 Reasons for Leaving
        const ctx12b = document.getElementById('reasonsChart').getContext('2d');
        new Chart(ctx12b, {
            type: 'bar',
            data: {
                labels: ['L∆∞∆°ng th·∫•p', 'M√¥i tr∆∞·ªùng l√†m vi·ªác', 'Thi·∫øu c∆° h·ªôi thƒÉng ti·∫øn', '√Åp l·ª±c c√¥ng vi·ªác', 'Chuy·ªÉn ng√†nh ngh·ªÅ'],
                datasets: [{
                    label: 'S·ªë ng∆∞·ªùi',
                    data: [15, 12, 9, 7, 5],
                    backgroundColor: ['#ef4444', '#f59e0b', '#f59e0b', '#10b981', '#10b981']
                }]
            },
            options: {
                ...chartConfig,
                indexAxis: 'y',
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 18
                    }
                },
                plugins: {
                    ...chartConfig.plugins,
                    legend: { display: false },
                    datalabels: {
                        anchor: 'end',
                        align: 'end',
                        formatter: function(value, context) {
                            const changes = ['+3', '+2', '+1', '0', '-1'];
                            const change = changes[context.dataIndex];
                            return value + ' (' + change + ')';
                        },
                        color: '#1f2937',
                        font: { weight: 'bold', size: 12 }
                    }
                },
                layout: {
                    padding: { left: 8, right: 40, top: 8, bottom: 8 }
                }
            }
        });

        // PAGE 3: Salary Charts
        // Shared salary data
        const salaryData = {
            departments: ['H√†nh ch√≠nh nh√¢n s·ª±', 'MnR', 'Qu·∫£n l√Ω r·ªóng', 'K·∫ø to√°n - T√†i ch√≠nh', 'Khai th√°c', 'T·ªï Th∆∞∆°ng V·ª•'],
            months: ['T9', 'T10', 'T11', 'T12', 'T1', 'T2'],
            monthsFull: ['Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12', 'Th√°ng 1', 'Th√°ng 2'],
            staff: [65, 55, 40, 50, 20, 15],
            totalSalary: [348, 297, 180, 240, 77, 58], // Millions
            baseSalary: [280, 220, 150, 200, 60, 45],
            bonus: [42, 55, 18, 25, 12, 9],
            allowance: [26, 22, 12, 15, 5, 4],
            lastYearChange: [8.2, 12.5, 5.3, 6.7, 8.5, 11.2],
            // Monthly data by department
            monthlyData: {
                'H√†nh ch√≠nh nh√¢n s·ª±': [320, 325, 330, 335, 340, 348],
                'MnR': [265, 270, 275, 280, 290, 297],
                'Qu·∫£n l√Ω r·ªóng': [165, 168, 172, 175, 178, 180],
                'K·∫ø to√°n - T√†i ch√≠nh': [220, 223, 228, 232, 236, 240],
                'Khai th√°c': [70, 72, 73, 74, 76, 77],
                'T·ªï Th∆∞∆°ng V·ª•': [50, 52, 54, 55, 57, 58]
            },
            monthlyStaff: {
                'H√†nh ch√≠nh nh√¢n s·ª±': [60, 61, 62, 63, 64, 65],
                'MnR': [52, 52, 53, 54, 55, 55],
                'Qu·∫£n l√Ω r·ªóng': [38, 38, 39, 39, 40, 40],
                'K·∫ø to√°n - T√†i ch√≠nh': [48, 48, 49, 49, 50, 50],
                'Khai th√°c': [18, 19, 19, 20, 20, 20],
                'T·ªï Th∆∞∆°ng V·ª•': [14, 14, 15, 15, 15, 15]
            }
        };

        // Calculate total monthly salary
        const totalMonthlySalary = salaryData.months.map((_, idx) => {
            return salaryData.departments.reduce((sum, dept) => {
                return sum + salaryData.monthlyData[dept][idx];
            }, 0);
        });

        // Calculate average per employee
        const avgSalaryPerEmployee = salaryData.totalSalary.map((sal, idx) => (sal / salaryData.staff[idx]).toFixed(1));

        // Gauge Chart: Total Salary & Budget (180 degrees with color gradient)
        const ctxGauge1 = document.getElementById('salaryBudgetGauge').getContext('2d');
        const budgetUsedPercent = (1200 / 1300) * 100;
        
        // Determine color based on percentage
        let gaugeColor;
        if (budgetUsedPercent >= 95) {
            gaugeColor = '#ef4444'; // Red
        } else if (budgetUsedPercent >= 85) {
            gaugeColor = '#f59e0b'; // Orange
        } else if (budgetUsedPercent >= 75) {
            gaugeColor = '#10b981'; // Green
        } else {
            gaugeColor = '#0ea5e9'; // Blue
        }
        
        new Chart(ctxGauge1, {
            type: 'doughnut',
            data: {
                labels: ['ƒê√£ D√πng', 'C√≤n L·∫°i'],
                datasets: [{
                    data: [budgetUsedPercent, 100 - budgetUsedPercent],
                    backgroundColor: [gaugeColor, '#e5e7eb'],
                    borderWidth: 0,
                    circumference: 180,
                    rotation: 270
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: { display: false },
                    datalabels: { display: false },
                    tooltip: { enabled: false }
                }
            }
        });

        // Chart 1: Salary Trend Over Time with Budget Line
        const ctxSalaryTrend = document.getElementById('salaryTrendChart').getContext('2d');
        const budgetLine = [1300, 1300, 1300, 1300, 1300, 1300]; // Budget remains constant
        
        new Chart(ctxSalaryTrend, {
            type: 'line',
            data: {
                labels: salaryData.monthsFull,
                datasets: [
                    {
                        label: 'Ng√¢n S√°ch',
                        data: budgetLine,
                        borderColor: '#ef4444',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0,
                        pointRadius: 4,
                        pointBackgroundColor: '#ef4444',
                        order: 1
                    },
                    {
                        label: 'T·ªïng Qu·ªπ L∆∞∆°ng (Tri·ªáu)',
                        data: totalMonthlySalary,
                        borderColor: colors.success,
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: colors.success,
                        order: 2
                    }
                ]
            },
            options: {
                ...chartConfig,
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 1000,
                        max: 1400,
                        ticks: {
                            callback: function(value) {
                                return value + 'M';
                            }
                        }
                    }
                },
                plugins: {
                    ...chartConfig.plugins,
                    legend: { display: true, position: 'bottom' }
                }
            }
        });

        // Chart 2: Salary by Department with % and +/- last year
        const ctxSalaryByDept = document.getElementById('salaryByDeptChart').getContext('2d');
        const totalSalarySum = salaryData.totalSalary.reduce((a, b) => a + b, 0);
        const salaryPercent = salaryData.totalSalary.map(s => ((s / totalSalarySum) * 100).toFixed(1));
        
        new Chart(ctxSalaryByDept, {
            type: 'bar',
            data: {
                labels: salaryData.departments,
                datasets: [{
                    label: 'T·ªïng L∆∞∆°ng (Tri·ªáu)',
                    data: salaryData.totalSalary,
                    backgroundColor: [
                        colors.primary,
                        colors.success,
                        colors.warning,
                        colors.info,
                        '#f59e0b'
                    ],
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: function(value, context) {
                            const idx = context.dataIndex;
                            const percent = salaryPercent[idx];
                            const change = salaryData.lastYearChange[idx];
                            return value + 'M\n' + percent + '%\n+' + change + '%';
                        },
                        color: '#1f2937',
                        font: { weight: 'bold', size: 10 }
                    }
                }]
            },
            plugins: [ChartDataLabels],
            options: {
                ...chartConfig,
                plugins: {
                    ...chartConfig.plugins,
                    legend: { display: false },
                    datalabels: { display: true }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return value + 'M';
                            }
                        }
                    }
                }
            }
        });

        // Chart 3: Salary Structure
        const ctxSalaryStructure = document.getElementById('salaryStructureChart').getContext('2d');
        const totalBase = salaryData.baseSalary.reduce((a, b) => a + b, 0);
        const totalBonus = salaryData.bonus.reduce((a, b) => a + b, 0);
        const totalAllowance = salaryData.allowance.reduce((a, b) => a + b, 0);
        const structureTotal = totalBase + totalBonus + totalAllowance;
        
        new Chart(ctxSalaryStructure, {
            type: 'doughnut',
            data: {
                labels: ['L∆∞∆°ng C∆° B·∫£n', 'Th∆∞·ªüng', 'Ph·ª• C·∫•p'],
                datasets: [{
                    data: [totalBase, totalBonus, totalAllowance],
                    backgroundColor: [colors.primary, colors.success, colors.warning],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    datalabels: {
                        color: '#fff',
                        font: { weight: 'bold', size: 13 },
                        formatter: function(value, context) {
                            const percent = ((value / structureTotal) * 100).toFixed(1);
                            return value + 'M\n' + percent + '%';
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.parsed;
                                const percent = ((value / structureTotal) * 100).toFixed(1);
                                return label + ': ' + value + 'M (' + percent + '%)';
                            }
                        }
                    }
                }
            },
            plugins: [ChartDataLabels]
        });

        // Chart 4: Heatmap with Toggle
        function renderHeatmap(metric) {
            const heatmapContainer = document.getElementById('salary-heatmap');
            let data, maxVal, minVal, unit, label, colorScheme;
            
            if (metric === 'salary') {
                data = salaryData.monthlyData;
                maxVal = Math.max(...Object.values(data).flat());
                minVal = Math.min(...Object.values(data).flat());
                unit = 'M';
                label = 'L∆∞∆°ng';
                colorScheme = { r: 16, g: 185, b: 129 }; // Green
            } else if (metric === 'staff') {
                data = salaryData.monthlyStaff;
                maxVal = Math.max(...Object.values(data).flat());
                minVal = Math.min(...Object.values(data).flat());
                unit = '';
                label = 'NV';
                colorScheme = { r: 37, g: 99, b: 235 }; // Blue
            } else {
                // avgCost = salary / staff
                data = {};
                salaryData.departments.forEach(dept => {
                    data[dept] = salaryData.months.map((_, idx) => {
                        return (salaryData.monthlyData[dept][idx] / salaryData.monthlyStaff[dept][idx]).toFixed(1);
                    });
                });
                maxVal = Math.max(...Object.values(data).flat().map(Number));
                minVal = Math.min(...Object.values(data).flat().map(Number));
                unit = 'M';
                label = 'TB/NV';
                colorScheme = { r: 245, g: 158, b: 11 }; // Orange
            }
            
            let html = '<div style="font-size: 12px;">';
            
            // Color Legend
            html += '<div style="display: flex; align-items: center; justify-content: center; margin-bottom: 12px; gap: 15px;">';
            html += '<span style="font-size: 11px; font-weight: 600; color: #6b7280;">Ch√∫ th√≠ch m√†u:</span>';
            html += '<div style="display: flex; align-items: center; gap: 10px;">';
            
            // Create 5 color samples from min to max
            for (let i = 0; i < 5; i++) {
                const intensity = (i / 4) * 0.7 + 0.15;
                const bgColor = `rgba(${colorScheme.r}, ${colorScheme.g}, ${colorScheme.b}, ${intensity})`;
                const value = minVal + (maxVal - minVal) * (i / 4);
                const displayValue = Math.round(value);
                html += `<div style="display: flex; align-items: center; gap: 4px;">`;
                html += `<div style="width: 20px; height: 20px; background: ${bgColor}; border: 1px solid #e5e7eb; border-radius: 3px;"></div>`;
                html += `<span style="font-size: 10px; color: #6b7280;">${displayValue}${unit}</span>`;
                html += `</div>`;
            }
            html += '</div></div>';
            
            // Header
            html += '<div style="display: grid; grid-template-columns: 140px repeat(6, 1fr); gap: 2px;">';
            html += '<div style="padding: 8px; text-align: center; font-weight: 600; background: #f9fafb; border: 1px solid #e5e7eb;"></div>';
            salaryData.months.forEach(month => {
                html += `<div style="padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #f9fafb; border: 1px solid #e5e7eb;">${month}</div>`;
            });
            html += '</div>';
            
            // Data rows
            salaryData.departments.forEach(dept => {
                html += '<div style="display: grid; grid-template-columns: 140px repeat(6, 1fr); gap: 2px;">';
                html += `<div style="padding: 8px; font-weight: 600; font-size: 11px; background: #f9fafb; border: 1px solid #e5e7eb; text-align: right; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${dept}</div>`;
                
                data[dept].forEach(val => {
                    const numVal = parseFloat(val);
                    const intensity = ((numVal - minVal) / (maxVal - minVal)) * 0.7 + 0.15;
                    const bgColor = `rgba(${colorScheme.r}, ${colorScheme.g}, ${colorScheme.b}, ${intensity})`;
                    const textColor = intensity > 0.5 ? '#fff' : '#1f2937';
                    html += `<div style="padding: 10px 6px; text-align: center; font-weight: 600; background: ${bgColor}; color: ${textColor}; border: 1px solid #e5e7eb;">${val}${unit}</div>`;
                });
                html += '</div>';
            });
            
            html += '</div>';
            heatmapContainer.innerHTML = html;
        }
        
        // Initial render
        renderHeatmap('salary');
        
        // Toggle buttons
        const heatmapButtons = document.querySelectorAll('.heatmap-toggle-btn');
        heatmapButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                heatmapButtons.forEach(b => {
                    b.classList.remove('active');
                    b.style.background = 'white';
                    b.style.color = '#6b7280';
                    b.style.borderColor = '#e5e7eb';
                });
                this.classList.add('active');
                this.style.background = '#2563eb';
                this.style.color = 'white';
                this.style.borderColor = '#2563eb';
                
                const metric = this.getAttribute('data-metric');
                renderHeatmap(metric);
            });
        });

        // PAGE 4: Work Charts

        // Chart 1: Work Count & Completion Rate Over Time
        const ctx16 = document.getElementById('workTrendChart4');
        const existingChart16 = Chart.getChart(ctx16);
        if (existingChart16) {
            existingChart16.destroy();
        }
        new Chart(ctx16, {
            type: 'bar',
            data: {
                labels: ['Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12', 'Th√°ng 1', 'Th√°ng 2'],
                datasets: [
                    {
                        label: 'T·ªïng C√¥ng Vi·ªác',
                        data: [65, 72, 68, 75, 82, 87],
                        backgroundColor: ['#3b82f6', '#2563eb', '#1d4ed8', '#1e40af', '#1e3a8a', '#172554'],
                        yAxisID: 'y',
                        order: 2,
                        borderRadius: 4
                    },
                    {
                        label: 'T·ª∑ L·ªá Ho√†n Th√†nh (%)',
                        data: [58.5, 61.1, 64.7, 68.0, 70.7, 74.7],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        type: 'line',
                        yAxisID: 'y',
                        order: 1,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                            display: false
                        }
                    }
                }
            }
        });

        // Chart 2: Department Completion Rate Bar Chart
        const ctx_dept = document.getElementById('deptCompletionChart4');
        const existingChartDept = Chart.getChart(ctx_dept);
        if (existingChartDept) {
            existingChartDept.destroy();
        }
        new Chart(ctx_dept, {
            type: 'bar',
            data: {
                labels: ['Nh√¢n s·ª±', 'IT', 'H·∫° t·∫ßng', 'An ninh'],
                datasets: [
                    {
                        label: 'T·ª∑ L·ªá Ho√†n Th√†nh (%)',
                        data: [85, 78, 92, 88],
                        backgroundColor: [
                            '#667eea',
                            '#f5576c',
                            '#00f2fe',
                            '#fa709a'
                        ],
                        borderRadius: 8
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const previous = [82, 75, 90, 86];
                                const current = context.parsed.x;
                                const diff = current - previous[context.dataIndex];
                                const sign = diff >= 0 ? '+' : '';
                                return 'So v·ªõi th√°ng tr∆∞·ªõc: ' + sign + diff.toFixed(1) + '%';
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        title: {
                            display: true,
                            text: 'T·ª∑ L·ªá Ho√†n Th√†nh (%)'
                        }
                    }
                }
            }
        });

        // Chart 4: Stacked Bar for Backlog + New Work
        const ctx17 = document.getElementById('workPlanChart');
        const existingChart17 = Chart.getChart(ctx17);
        if (existingChart17) {
            existingChart17.destroy();
        }
        new Chart(ctx17, {
            type: 'bar',
            data: {
                labels: ['Nh√¢n s·ª±', 'IT', 'H·∫° t·∫ßng', 'An ninh'],
                datasets: [
                    {
                        label: 'T·ªìn K·ª≥ Tr∆∞·ªõc',
                        data: [12, 18, 8, 10],
                        backgroundColor: '#f59e0b',
                        datalabels: {
                            display: true,
                            color: '#fff',
                            font: { weight: 'bold', size: 11 },
                            formatter: function(value) { return value; }
                        }
                    },
                    {
                        label: 'M·ªõi Ph√°t Sinh',
                        data: [25, 32, 15, 20],
                        backgroundColor: '#3b82f6',
                        datalabels: {
                            display: true,
                            color: '#fff',
                            font: { weight: 'bold', size: 11 },
                            formatter: function(value) { return value; }
                        }
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'S·ªë L∆∞·ª£ng C√¥ng Vi·ªác'
                        }
                    },
                    y: {
                        stacked: true
                    }
                }
            }
        });

        // Set current date in nav footer
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const year = today.getFullYear();
        const hour = String(today.getHours()).padStart(2, '0');
        const minute = String(today.getMinutes()).padStart(2, '0');
        document.getElementById('lastUpdate').textContent = 'C·∫≠p nh·∫≠t:\n' + day + '/' + month + '/' + year;

        // Close modal when clicking outside
        document.getElementById('helpModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeHelpModal();
            }
        });
    </script>



    <script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
